<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="DAO.MemberInfoDAO">

	<!-- 회원이 쓴 모든 댓글 -->
	<select id="getAllReply"  resultType="DTO.ReplyDTO">
		SELECT * FROM replay WHERE email=#{EMAIL} order by regdate DESC
	</select>
	
	<!-- 자신이 쓴 모든 게시물 _ 자유-->
	<!-- active=0 인것은 삭제되지 않은 것만 -->
 	<select id="getFreeNotice"  resultType="DTO.BoardFreeDTO">
		SELECT l.boardno, l.title, l.memberno , l.countno, l.regdate FROM boardfree l join memberdb m 
		WHERE l.memberno=m.memberno and m.memberno=#{memberno}
		and l.active=0
		order by regdate desc
	</select>
	
	<!-- 자유 게시판 글 갯수 -->
	<select id="getFreeCount" resultType="Integer">
		SELECT COUNT(*) CNT
		FROM boardfree
		WHERE active = 0 and memberno = #{memberno}
	</select>
	
	<!-- 자신이 쓴 모든 게시물 _ 변호사-->
 	<select id="getLawNotice"  resultType="DTO.BoardLawDTO">
 		SELECT l.boardno, l.title, l.memberno, l.countno ,l.regdate FROM boardlaw l join memberdb m 
		WHERE l.memberno=m.memberno and m.memberno=#{memberno}
		and l.active=0
		order by regdate desc
	</select>

	<!-- 변호사 게시판 글 갯수 -->
	<select id="getLawCount" resultType="Integer">
		SELECT COUNT(*) CNT
		FROM boardlaw
		WHERE active = 0 and memberno = #{memberno}
	</select>
	
 
	<!-- 자신의 정보 -->
	<select id="getMember"  resultType="DTO.MemberDTO">
		SELECT * FROM memberdb WHERE email=#{EMAIL}
	</select>
		
	<!-- //자기정보 수정하기 -->
	<update id="update" parameterType="DTO.MemberDTO">
		UPDATE memberdb
		SET message=#{message}
		WHERE memberno=#{memberno}
	</update>

	
	<!-- (회원 탈퇴) -->
	<update id="delete"  parameterType="DTO.MemberDTO">
		UPDATE MEMBERDB  SET ACTIVE = 1  WHERE MEMBERNO = #{MEMBERNO}
	</update>
	
	<!-- 비번변경 -->
	<update id="changepassword"  parameterType="DTO.MemberDTO">
		UPDATE MEMBERDB
		SET password=#{npassword},
		regpwd=sysdate()
		WHERE memberno = #{memberno}
	</update>
	
</mapper>