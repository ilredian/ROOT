<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="DAO.BoardFreeDAO">
 
 <select id="getCount" resultType="Integer">
  SELECT COUNT(*) CNT 
  FROM NOTICES 
  WHERE ${param1} LIKE '%${param2}%'
 </select> 
 <select id="getNotices" resultType="DTO.BoardFreeDTO">
     SELECT * FROM
               ( SELECT ROWNUM NUM, N.* 
                 FROM 
                     ( SELECT * 
                       FROM NOTICES 
                       WHERE ${param2} LIKE '%${param3}%' ORDER BY REGDATE DESC) N
                ) WHERE NUM BETWEEN 1 + (${param1}-1)*5 AND 5 + (${param1}-1)*5
    </select>
 <select id="getNotice" resultType="DTO.BoardFreeDTO">
     <!--   Notice getNotice(String seq) 
            parameter 하나짜리는[ 변수이름 ] (param1 은 안되요)
     -->
     SELECT * FROM NOTICES WHERE SEQ=#{seq}
</select>
 <delete id="delete" >
     <!-- int delete(String seq)  
       parameterType="Interger" 을 생략해 볼게요
     -->
     DELETE NOTICES WHERE SEQ=#{seq}
 </delete>
 <update id="update" >
     <!-- int update(Notice notice)   
       parameter  객체로 ..... Notice 객체 (만약에 setter , getter 가 구현되어 있다면)
     -->
     UPDATE NOTICES SET TITLE=#{title}, CONTENT=#{content}, FILESRC=#{fileSrc ,jdbcType=VARCHAR} WHERE SEQ=#{seq}
 </update>
 <insert id="insert">
     <!-- int insert( Notice n ) 
        INSERT INTO TNOTICES(SEQ, TITLE, CONTENT, WRITER, REGDATE, HIT, FILESRC , FILESRC2)
        VALUES( (SELECT MAX(TO_NUMBER(SEQ))+1 FROM TNOTICES), :title, :content, :writer, SYSDATE, 0, :fileSrc , :fileSrc2)
     -->
      <selectKey order="BEFORE" keyProperty="seq" resultType="String">
       SELECT NVL(MAX(TO_NUMBER(SEQ)),0)+1 FROM NOTICES
      </selectKey>
      INSERT INTO NOTICES(SEQ, TITLE, CONTENT, WRITER, REGDATE, HIT, FILESRC , FILESRC2)
      VALUES( #{seq}, #{title}, #{content}, #{writer}, SYSDATE, 0, #{fileSrc ,jdbcType=VARCHAR} , #{fileSrc2 ,jdbcType=VARCHAR})
</insert>

</mapper>
